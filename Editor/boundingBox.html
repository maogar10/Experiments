<DOCTYPE html>
<html>
  <head>
    <title>cannon.js - motion states demo</title>
    <meta charset="utf-8">
    <style>* {margin:0;padding:0}</style>
  </head>
  <body>
    <script src="js/cannon.js"></script>
    <script src="js/cannon.demo.js"></script>
    <script src="js/dat.gui.js"></script>
    <script src="js/three.js"></script>
    <script src="js/detector.js"></script>
    <script src="js/stats.js"></script>
    
    <script>


            // console.log((nx*ny*nz)+" spheres");

            // Create world
            var world = new CANNON.World();
            app.setWorld(world);
            world.gravity.set(0,0,-10);
            world.broadphase = new CANNON.NaiveBroadphase();
            world.solver.iterations = 30;
            world.solver.k = 2000;
            world.solver.d = 20;
            var groundShape = new CANNON.Plane(new CANNON.Vec3(0,0,1));
            var mass = 0; // mass=0 will produce a static body automatically
            var groundBody = new CANNON.RigidBody(mass,groundShape);
            world.add(groundBody);
            app.addVisual(groundBody);
            
            // Materials
            var stone = new CANNON.Material('stone');
            var stone_stone = new CANNON.ContactMaterial(stone,
          					       stone,
          					       0.3, // friction
          					       0.3  // Restitution
          					       );
            world.addContactMaterial(stone_stone);


            // Dynamic Sphere
            // world.allowSleep = true;

            // Sphere on plane
            var rand = 0.01;
            var h = 0;
            var b1 = new CANNON.Box(new CANNON.Vec3(0.5,3,1)); // Sharing shape saves memory
            var b2 = new CANNON.Box(new CANNON.Vec3(3.0,0.5,1)); // Sharing shape saves memory
            // var sphereBody;
            // var b3 = new CANNON.Sphere(2)
            var b3 = new CANNON.Box(new CANNON.Vec3(1,1,1)); // Sharing shape saves memory
            var bird = new CANNON.RigidBody(10,b3,stone);
            bird.position.set(-50,-50,1);
            // bird.velocity.set(-50,-50,10);
            // bird.angularVelocity.set(3,1,2  );
            bird.angularDamping = 0;
            // sphereBody.quaternion.z += Math.sin( n%2 / Math.PI)
            // console.log(bird)
            
            document.body.addEventListener('keydown', function(e){
              bird.position.z+=0.1
               bird.velocity.set(50,50,15);
               bird.angularVelocity.set(3*Math.random(),3*Math.random(),3*Math.random()  );
            })
            world.add(bird);
    	      app.addVisual(bird);
            for(var n=0;n<7;n++){
              for(var i=0;i<2; i++){
                if(n%2==0){
                  var sphereBody = new CANNON.RigidBody(1,b1,stone);
                  sphereBody.position.set(-2.5+5*i,0,
          				      1+2*n);
                  // sphereBody.quaternion.z += Math.sin( n%2 / Math.PI)
                  // console.log(sphereBody)
                  world.add(sphereBody);
          	      app.addVisual(sphereBody);
                } else {
                  var sphereBody = new CANNON.RigidBody(10,b2,stone);
                  sphereBody.position.set(0,-2.5+i*5,
          				      1+2*n);
                  // sphereBody.quaternion.z += Math.sin( n%2 / Math.PI)
                  // console.log(sphereBody)
                  world.add(sphereBody);
          	      app.addVisual(sphereBody);
                }
              }
            }
              for(var n=0;n<5;n++){
                for(var i=0;i<2; i++){
                  if(n%2==0){
                    var sphereBody = new CANNON.RigidBody(1,b1,stone);
                    sphereBody.position.set(8+-2.5+5*i,8,
            				      1+2*n);
                    // sphereBody.quaternion.z += Math.sin( n%2 / Math.PI)
                    // console.log(sphereBody)
                    world.add(sphereBody);
            	      app.addVisual(sphereBody);
                  } else {
                    var sphereBody = new CANNON.RigidBody(10,b2,stone);
                    sphereBody.position.set(8,8+-2.5+i*5,
            				      1+2*n);
                    // sphereBody.quaternion.z += Math.sin( n%2 / Math.PI)
                    // console.log(sphereBody)
                    world.add(sphereBody);
            	      app.addVisual(sphereBody);
                  }
                }
              
            }
          }

        </script>
      </body>
    </html>
